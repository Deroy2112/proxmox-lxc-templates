const k=new Map;function D(){const e=document.getElementById("search-input"),n=document.getElementById("template-grid"),g=document.getElementById("no-results"),r=n?.querySelectorAll(".app-card"),i=document.querySelectorAll("#category-pills .pill"),u=document.querySelectorAll(".sidebar-nav button[data-category]"),E=document.getElementById("visible-count");if(!n||!r)return;let l="all",m="";k.clear(),r.forEach(t=>{const a=t.getAttribute("data-template");if(a)try{const f=JSON.parse(a);k.set(f.name,f)}catch{}});const y=new URLSearchParams(window.location.search),h=y.get("q")||"",o=y.get("category")||"all";h&&e&&(e.value=h,m=h.toLowerCase()),l=o;function c(){i.forEach(t=>{const a=t.getAttribute("data-category");t.classList.toggle("active",a===l)}),u.forEach(t=>{const a=t.getAttribute("data-category");t.classList.toggle("active",a===l)})}function d(){let t=0;r.forEach(a=>{const f=a.getAttribute("data-name")||"",S=a.getAttribute("data-description")||"",b=a.getAttribute("data-category")||"",I=(!m||f.includes(m)||S.includes(m))&&(l==="all"||b===l);a.style.display=I?"":"none",I&&t++}),E&&(E.textContent=String(t)),g?.classList.toggle("hidden",t>0),n?.classList.toggle("hidden",t===0&&r.length>0)}let L;e?.addEventListener("input",()=>{clearTimeout(L),L=setTimeout(()=>{m=e.value.toLowerCase(),document.getElementById("template-detail")?.classList.contains("hidden")||T(),d();const t=new URL(window.location.href);m?t.searchParams.set("q",e.value):t.searchParams.delete("q"),history.replaceState(null,"",t.toString())},150)});function w(t){l=t,document.getElementById("template-detail")?.classList.contains("hidden")||T(),c(),d();const a=new URL(window.location.href);l!=="all"?a.searchParams.set("category",l):a.searchParams.delete("category"),history.replaceState(null,"",a.toString())}i.forEach(t=>{t.addEventListener("click",()=>{w(t.getAttribute("data-category")||"all")})}),u.forEach(t=>{t.addEventListener("click",()=>{w(t.getAttribute("data-category")||"all"),document.querySelector(".sidebar")?.classList.remove("open"),document.getElementById("sidebar-overlay")?.classList.remove("open")})}),c(),d()}function F(e){A(e),document.getElementById("template-list")?.classList.add("hidden"),document.getElementById("template-detail")?.classList.remove("hidden");const n=new URL(location.href);n.searchParams.set("template",e.name),n.searchParams.delete("q"),n.searchParams.delete("category"),history.pushState({template:e.name},"",n),window.scrollTo({top:0,behavior:"smooth"})}function T(){document.getElementById("template-detail")?.classList.add("hidden"),document.getElementById("template-list")?.classList.remove("hidden");const e=new URL(location.href);e.searchParams.delete("template"),history.pushState({},"",e)}function p(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}function K(e){const n=/^## \[[\d.]+-?\d*\]/m,g=e.split(`
`),r=[];let i=!1;for(const u of g){if(n.test(u)){if(i)break;i=!0}i&&r.push(u)}return r.join(`
`).trim()||e}function A(e){const n=`https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons@main/svg/${e.icon}.svg`,g=e.name.charAt(0).toUpperCase()+e.name.slice(1),r=document.getElementById("detail-icon");r&&(r.src=n);const i=document.getElementById("detail-name");i&&(i.textContent=g);const u=document.getElementById("detail-description");u&&(u.textContent=e.description);const E=document.getElementById("detail-badges");E&&(E.innerHTML=`
        <span class="badge badge-success">v${e.version}-${e.build_version}</span>
        <span class="tag">${e.base_os}</span>
        <span class="badge badge-info">${e.category}</span>
      `);const l=document.getElementById("detail-download-section"),m=document.getElementById("detail-wget"),y=document.getElementById("detail-sha512");if(e.download_url){l?.classList.remove("hidden"),m&&(m.value=`wget ${e.download_url}`);const s=document.getElementById("detail-sha512-wrapper");y&&s&&(e.sha512?(y.value=`SHA512: ${e.sha512}`,y.setAttribute("data-sha512",e.sha512),s.classList.remove("hidden")):(y.value="",s.classList.add("hidden")))}else l?.classList.add("hidden");const h=document.getElementById("detail-quickstart-section"),o=document.getElementById("detail-quickstart");e.quick_start&&h&&o?(h.classList.remove("hidden"),o.innerHTML=`<pre><code>${p(e.quick_start)}</code></pre>`):h?.classList.add("hidden");const c=document.getElementById("detail-resources"),d=e.resources;if(c&&d){const s=d.memory_recommended,v=d.memory_min;c.innerHTML=`
        <div class="stat">
          <div class="stat-value">${s>=1024?s/1024+"GB":s+"MB"}</div>
          <div class="stat-label">Memory</div>
          <div class="stat-desc">min: ${v>=1024?v/1024+"GB":v+"MB"}</div>
        </div>
        <div class="stat">
          <div class="stat-value">${d.disk_recommended}</div>
          <div class="stat-label">Disk</div>
          <div class="stat-desc">min: ${d.disk_min}</div>
        </div>
        <div class="stat">
          <div class="stat-value">${d.cores}</div>
          <div class="stat-label">${d.cores===1?"Core":"Cores"}</div>
        </div>
      `}const L=document.getElementById("detail-ports-section"),w=document.getElementById("detail-ports"),t=e.ports;t?.length&&L&&w?(L.classList.remove("hidden"),w.innerHTML=t.map(s=>`<tr><td class="font-mono">${s.port}</td><td>${p(s.description)}</td></tr>`).join("")):L?.classList.add("hidden");const a=document.getElementById("detail-paths-section"),f=document.getElementById("detail-paths"),S=e.paths;S?.length&&a&&f?(a.classList.remove("hidden"),f.innerHTML=S.map(s=>`<tr><td class="font-mono text-xs">${p(s.path)}</td><td>${p(s.description)}</td></tr>`).join("")):a?.classList.add("hidden");const b=document.getElementById("detail-credentials-section"),C=document.getElementById("detail-credentials"),B=e.credentials;if(B&&b&&C){b.classList.remove("hidden");let s=`User: <code>${p(B.username)}</code> / Pass: <code>${p(B.password)}</code>`;B.note&&(s+=`<br><span class="text-muted">${p(B.note)}</span>`),C.innerHTML=s}else b?.classList.add("hidden");const I=document.getElementById("detail-faq-section"),$=document.getElementById("detail-faq"),M=e.faq;M?.length&&I&&$?(I.classList.remove("hidden"),$.innerHTML=M.map((s,v)=>`
        <div class="accordion-item ${v===0?"open":""}">
          <button class="accordion-header">
            ${p(s.question)}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor">
              <path d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z" />
            </svg>
          </button>
          <div class="accordion-content"><p>${p(s.answer)}</p></div>
        </div>
      `).join(""),$.querySelectorAll(".accordion-header").forEach(s=>{s.addEventListener("click",()=>{s.parentElement?.classList.toggle("open")})})):I?.classList.add("hidden");const q=document.getElementById("detail-changelog-section"),_=document.getElementById("detail-changelog"),x=document.getElementById("changelog-item");if(e.changelog&&q&&_&&x){q.classList.remove("hidden"),x.classList.remove("open");const s=e.changelog,v=K(s);_.innerHTML=`<p>${p(v).replace(/\n/g,"<br>")}</p>`}else q?.classList.add("hidden");const H=document.getElementById("detail-release-section"),P=document.getElementById("detail-release-date"),U=document.getElementById("detail-github-link");e.release_url||e.release_date?(H?.classList.remove("hidden"),e.release_date&&P&&(P.textContent=`Released: ${new Date(e.release_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`),e.release_url&&U&&(U.href=e.release_url)):H?.classList.add("hidden")}function R(){const n=document.getElementById("template-grid")?.querySelectorAll(".app-card"),g=document.getElementById("back-to-list"),r=document.getElementById("detail-wget-copy"),i=document.getElementById("detail-wget"),u=document.getElementById("detail-sha512-copy");r?.addEventListener("click",async()=>{if(i?.value)try{await navigator.clipboard.writeText(i.value),window.showToast?.("Copied to clipboard!")}catch{i.select(),document.execCommand("copy"),window.showToast?.("Copied!")}}),u?.addEventListener("click",async()=>{const c=document.getElementById("detail-sha512")?.getAttribute("data-sha512");if(c)try{await navigator.clipboard.writeText(c),window.showToast?.("SHA512 copied to clipboard!")}catch{window.showToast?.("Failed to copy")}});const E=document.getElementById("changelog-toggle"),l=document.getElementById("changelog-item");E?.addEventListener("click",()=>{l?.classList.toggle("open")});function m(o){const c=o.getAttribute("data-template");if(c)try{const d=JSON.parse(c);F(d)}catch{}}n?.forEach(o=>{o.addEventListener("click",()=>m(o)),o.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),m(o))})}),g?.addEventListener("click",T),window.addEventListener("popstate",o=>{if(o.state?.template){const c=k.get(o.state.template);c&&(A(c),document.getElementById("template-list")?.classList.add("hidden"),document.getElementById("template-detail")?.classList.remove("hidden"))}else document.getElementById("template-detail")?.classList.add("hidden"),document.getElementById("template-list")?.classList.remove("hidden")});const h=new URLSearchParams(location.search).get("template");if(h){const o=k.get(h);o&&(A(o),document.getElementById("template-list")?.classList.add("hidden"),document.getElementById("template-detail")?.classList.remove("hidden"))}}function j(){const e=document.getElementById("menu-toggle"),n=document.querySelector(".sidebar"),g=document.getElementById("sidebar-overlay");e?.addEventListener("click",()=>{n?.classList.toggle("open"),g?.classList.toggle("open")}),g?.addEventListener("click",()=>{n?.classList.remove("open"),g?.classList.remove("open")})}function N(){document.addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),document.getElementById("search-input")?.focus())})}D();R();j();N();document.addEventListener("astro:after-swap",()=>{D(),R(),j(),N()});
