---
interface Props {
  name: string;
  description: string;
  category: string;
  icon: string;
  version: string;
  base_os: string;
  memory_min: number;
  href: string;
  index?: number;
}

const {
  name,
  description,
  category,
  icon,
  version,
  base_os,
  memory_min,
  href,
  index = 0,
} = Astro.props;

const iconUrl = `https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons@main/svg/${icon}.svg`;
const delay = Math.min(index * 0.05, 0.5);
---

<a
  href={href}
  class="template-card glass-card block p-5 transition-all duration-200 hover:-translate-y-1 hover:shadow-lg animate-fade-in"
  style={`animation-delay: ${delay}s`}
  data-category={category}
  data-name={name.toLowerCase()}
  data-description={description.toLowerCase()}
>
  <div class="flex items-start gap-4">
    <!-- Icon -->
    <div class="icon-box shrink-0" style={`--icon-color: var(--color-cat-${category})`}>
      <img
        src={iconUrl}
        alt=""
        loading="lazy"
        onerror="this.style.display='none';this.nextElementSibling.style.display='block'"
      />
      <svg class="fallback-icon" style="display:none" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-1 12H5c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h14c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1z"/>
      </svg>
    </div>

    <!-- Content -->
    <div class="flex-1 min-w-0">
      <div class="flex items-center gap-2 mb-1">
        <h3 class="font-semibold text-[var(--text-primary)] truncate">
          {name.charAt(0).toUpperCase() + name.slice(1)}
        </h3>
        <span class="px-2 py-0.5 text-xs font-medium rounded bg-[var(--bg-tertiary)] text-[var(--text-muted)]">
          v{version}
        </span>
      </div>
      <p class="text-sm text-[var(--text-secondary)] line-clamp-2 mb-3">
        {description}
      </p>
      <div class="flex items-center gap-3 text-xs text-[var(--text-muted)]">
        <span class="flex items-center gap-1">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"/>
          </svg>
          {base_os}
        </span>
        <span class="flex items-center gap-1">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"/>
          </svg>
          {memory_min} MB
        </span>
      </div>
    </div>
  </div>
</a>

<style>
  .template-card {
    opacity: 0;
  }
</style>
